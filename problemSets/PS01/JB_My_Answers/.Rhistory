getwd()
setwd("/Users/ierja/Documents/GitHub/StatsI_Fall2023/problemSets/JB_My_Answers/template")
# remove objects
rm(list=ls())
package.list <- setdiff(package.list, basic.packages)
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
lapply(c("stringr"),  pkgTest)
lapply(c("ggplot2"), pkgTest)
#####################
# Problem 1
#####################
# Part 1
y <- c(105, 69, 86, 100, 82, 111, 104, 110, 87, 108, 87, 90, 94, 113, 112, 98, 80, 97, 95, 111, 114, 89, 95, 126, 98)
length(y)
n <- length(y)
df <- (n-1)
# Find Mean of y
mean(y)
mean <- mean(y)
# Find Standard Deviation of y
sd(y)
sd <- sd(y)
# Since n < 30 we use t-statistic
t <-1.318
# CI_90 = mean +_ t (sd/sqrt(n))
Upper_CI_90 <- (mean + t(sd/sqrt(n)))
Lower_CI_90 <- (mean - t(sd/sqrt(n)))
#Problem 1 Part 2
# Changing t value to make alpha = 0.05
t <- 1.711
Upper_CI95 <- (100 + t(sd/sqrt(n)))
Lower_CI95 <- (100 - t(sd/sqrt(n)))
?t.test
?t.test
t.test(y, mu = 100)
t.test(y, mu = 100)
Lower_CI_90 <- (mean - t(sd/sqrt(n)))
# Since n < 30 we use t-statistic
t <-1.318
Lower_CI_90 <- (mean - t(sd/sqrt(n)))
expenditure <- read.table("https://raw.githubusercontent.com/ASDS-TCD/StatsI_Fall2023/main/datasets/expenditure.txt", header=T)
expenditure
lapply(c("ggplot2"), pkgTest)
plot(expediture$Y)
plot(expenditure$Y)
plot(expenditure$Y, aes(y=STATE x=Shelter)
plot(expenditure$Y, aes(y=STATE x=Shelter))
plot(expenditure$Y, aes(x=shelter, y=state ))
plot(expenditure$Y, aes(xlabel=shelter, ylabel=state ))
plot(expenditure$X1)
plot(expenditure$X2)
plot(expendiure$X3)
plot(expenditure$X3)
str(expenditure)
plot(expenditure$X3)
plot(expenditure$X3)
ggplot(expenditure$Y)
plot(expenditure$Y, main= "Expenditure on Shelters/Housing"
xlab = "State", ylab = "Dollars"
plot(expenditure$Y, main= "Expenditure on Shelters/Housing"
xlab = "State", ylab = "Dollars",
plot(expenditure$Y, main= "Expenditure on Shelters/Housing",
xlab = "State", ylab = "Dollars",
)
attach(expenditures)
expenditure <- read.table("https://raw.githubusercontent.com/ASDS-TCD/StatsI_Fall2023/main/datasets/expenditure.txt", header=T)
expenditure
str(expenditure)
attach(expenditures)
attach(expenditure)
par(mfrow = 2,2)
plot(expenditure$X3, main = "Number of People per Thousand residing in Urban Areas",
xlab = "Residents per 1000", ylab = "Living in Urban Area"
)
par(mfrow = 4,4)
[plot(expenditure$Y, main = "Expenditure on Shelters/Housing",
par(mfrow = c(4,4))
plot(expenditure$X3, main = "Number of People per Thousand residing in Urban Areas",
xlab = "Residents per 1000", ylab = "Living in Urban Area"
)
plot(expenditure$X3, main = "Residing in Urban Areas",
xlab = "R", ylab = "L"
)
plot(expenditure$X1, main = "Personal Income",
xlab = "Income", ylab = "Dollars",
)
attach(expenditure)
par(mfrow = c(2,2))
plot(expenditure$X1, main = "Personal Income",
xlab = "Income", ylab = "Dollars",
)
attach(expenditure)
plot(expenditure$Y, main = "Expenditure on Shelters/Housing",
xlab = "Housing", ylab = "Dollars",
)
plot(expenditure$X2, main = "Residents  'Financially Insecure",
xlab = "100,000", ylab = "Financially Insecure"
)
plot(expenditure$X3, main = "Residing in Urban Areas",
xlab = "R", ylab = "L"
)
# Code to get the plots to be shown together from https://www.statmethods.net/advgraphs/layout.html
attach(expenditure)
plot(expenditure$Y, main = "Expenditure on Shelters/Housing",
xlab = "Housing", ylab = "Dollars",
)
plot(expenditure$X1, main = "Personal Income",
xlab = "Income", ylab = "Dollars",
)
# Code to get the plots to be shown together from https://www.statmethods.net/advgraphs/layout.html
attach(expenditure)
par(mfrow = c(2,2))
plot(expenditure$Y, main = "Expenditure on Shelters/Housing",
xlab = "Housing", ylab = "Dollars",
)
plot(expenditure$X1, main = "Personal Income",
xlab = "Income", ylab = "Dollars",
)
plot(expenditure$X2, main = "Residents  'Financially Insecure",
xlab = "100,000", ylab = "Financially Insecure"
)
plot(expenditure$X3, main = "Residing in Urban Areas",
xlab = "R", ylab = "L"
)
# Code to get the plots to be shown together from https://www.statmethods.net/advgraphs/layout.html
attach(expenditure)
par(mfrow = c(2,2))
plot(expenditure$Y, main = "Expenditure on Shelters/Housing",
xlab = "Housing", ylab = "Dollars",
)
plot(expenditure$X1, main = "Personal Income",
xlab = "Per capita", ylab = "Income",
)
plot(expenditure$X2, main = "Residents  'Financially Insecure",
xlab = "Residents", ylab = "Financially Insecure"
)
plot(expenditure$X3, main = "Residing in Urban Areas",
xlab = "Residents", ylab = "L"
)
str(expenditure)
plot(expenditure$X1, expenditure$Y, main = "Expenditure on Shelters/Housing",
xlab = "Housing", ylab = "Dollars",
)
plot(expenditure$X1, expenditure$Y, main = "Expenditure on Shelters/Housing",
xlab = "Personal Income", ylab = "Shelter/Housing",
)
plot(expenditure$X3, expenditure$Y main = "Urban Area - Shelter Assistance",
# Code to get the plots to be shown together from https://www.statmethods.net/advgraphs/layout.html
attach(expenditure)
par(mfrow = c(2,2))
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance",
)
plot(expenditure$X2, expenditure$Y, main = "Financially Insecure - Shelter Assistance",
xlab = "Financially Insecure", ylab = "$Shelter Assistance",
)
plot(expenditure$X3, expenditure$Y, main = "Urban Area - Shelter Assistance",
xlab = "Residing Urban", ylab = "$Shelter Assistance"
)
plot(expenditure$Region, expenditure$Y, main = "Region vs Expenditure",
xlab = "Region", ylab = "Expenditure")
plot(expenditure$X1, expenditure$Y, expenditure$Region)
plot(c(expenditure$X1, expenditure$Y, expenditure$Region))
xlab = "Personal Income", ylab = "$Shelter Assistance",
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance")
# We see that in the graph mapping personal income, there is somewhat of a positive
# correlation between state spending on shelter assistance and the per capita personal
# income in the state, with greater variation in the middle of the graph.
# In the graph mapping financial insecurity, there is a vague "U" shape of the
# relationship, suggesting a somewhat postive correlation with a slight bump with the
# states with the highest numbers of financially insecure residents spending more on
# shelter assistance than a strong positive correlation would suggest.
# In the graph considering urban area, there is a very weak positive correlation
# between the amount states spend on urban assistance and the number of residents
# living in urban areas.
plot(expenditure$X1, expenditure$X2, main = "Personal Income vs Financially Insecure",
xlab = "Personal Income", ylab = "Financially Insecure"
)
plot(expenditure$X1, expenditure$X2, main = "Personal Income vs Urban Residing",
xlab = "Personal Income", ylab = "Urban Residing"
)
plot(expenditure$X1, expenditure$X3, main = "Personal Income vs Urban Residing",
xlab = "Personal Income", ylab = "Urban Residing"
)
# part 1
# Code to get the plots to be shown together from https://www.statmethods.net/advgraphs/layout.html
attach(expenditure)
par(mfrow = c(2,2))
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance",
)
plot(expenditure$X2, expenditure$Y, main = "Financially Insecure - Shelter Assistance",
xlab = "Financially Insecure", ylab = "$Shelter Assistance",
)
plot(expenditure$X3, expenditure$Y, main = "Urban Area - Shelter Assistance",
xlab = "Residing Urban", ylab = "$Shelter Assistance"
)
# We see that in the graph mapping personal income, there is somewhat of a positive
# correlation between state spending on shelter assistance and the per capita personal
# income in the state, with greater variation in the middle of the graph.
# In the graph mapping financial insecurity, there is a vague "U" shape of the
# relationship, suggesting a somewhat postive correlation with a slight bump with the
# states with the highest numbers of financially insecure residents spending more on
# shelter assistance than a strong positive correlation would suggest.
# In the graph considering urban area, there is a very weak positive correlation
# between the amount states spend on urban assistance and the number of residents
# living in urban areas.
plot(expenditure$X1, expenditure$X2, main = "Personal Income vs Financially Insecure",
xlab = "Personal Income", ylab = "Financially Insecure"
)
plot(expenditure$X1, expenditure$X3, main = "Personal Income vs Urban Residing",
xlab = "Personal Income", ylab = "Urban Residing"
)
plot(expenditure$X2, expenditure$X3, main = "Financially Insecure vs Urban Residing ",
xlab = "Personal Income", ylab = "Financially Insecure"
)
# We see that in the graph mapping personal income, there is somewhat of a positive
# correlation between state spending on shelter assistance and the per capita personal
# income in the state, with greater variation in the middle of the graph.
# In the graph mapping financial insecurity, there is a vague "U" shape of the
# relationship, suggesting a somewhat postive correlation with a slight bump with the
# states with the highest numbers of financially insecure residents spending more on
# shelter assistance than a strong positive correlation would suggest.
# In the graph considering urban area, there is a very weak positive correlation
# between the amount states spend on urban assistance and the number of residents
# living in urban areas.
par(mfrow = c(2,2))
plot(expenditure$X1, expenditure$X2, main = "Personal Income vs Financially Insecure",
xlab = "Personal Income", ylab = "Financially Insecure"
)
plot(expenditure$X1, expenditure$X3, main = "Personal Income vs Urban Residing",
xlab = "Personal Income", ylab = "Urban Residing"
)
attach(expenditure)
par(mfrow = c(2,2))
plot(expenditure$X1, expenditure$X2, main = "Personal Income vs Financially Insecure",
xlab = "Personal Income", ylab = "Financially Insecure"
)
plot(expenditure$X1, expenditure$X3, main = "Personal Income vs Urban Residing",
xlab = "Personal Income", ylab = "Urban Residing"
)
plot(expenditure$X2, expenditure$X3, main = "Financially Insecure vs Urban Residing ",
xlab = "Personal Income", ylab = "Financially Insecure"
)
plot(expenditure$Region, expenditure$Y, main = "Region vs Expenditure",
xlab = "Region", ylab = "Expenditure")
attach(expenditure)
par(mfrow = c(2,2))
plot(expenditure$X1, expenditure$X2, main = "Personal Income vs Financially Insecure",
xlab = "Personal Income", ylab = "Financially Insecure"
)
plot(expenditure$X1, expenditure$X3, main = "Personal Income vs Urban Residing",
xlab = "Personal Income", ylab = "Urban Residing"
)
plot(expenditure$X2, expenditure$X3, main = "Financially Insecure vs Urban Residing ",
xlab = "Financially Insecure", ylab = "Urban Residing"
)
plot(expenditure$Region, expenditure$Y, main = "Region vs Expenditure",
xlab = "Region", ylab = "Expenditure")
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance")
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance"
points(expenditure$Region, expenditure$Y, col="red"))
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance",
points(expenditure$Region, expenditure$Y, col="red"))
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance",
points(expenditure$Region, expenditure$Y, col="red"))
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance", col="darkgreen"
points(expenditure$Region, expenditure$Y, col="red"))
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance", col="darkgreen",
points(expenditure$Region, expenditure$Y, col="red"))
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance", col="red",
points(expenditure$Region, expenditure$Y, col="red"))
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance", col="red",
points(expenditure$Region, expenditure$Y, col="blue", pch=17))
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Expenditure",
xlab = "Personal Income", ylab = "$Shelter Assistance", col="red",
points(expenditure$Region, expenditure$Y, col="blue", pch=17))
plot(expenditure$X1, expenditure$Y, expenditure$Region, main = "Personal Income - Expenditure",
xlab = "Personal Income", ylab = "$Shelter Assistance", col="red",
points(expenditure$Region, expenditure$Y, col="blue", pch=17))
scatterplotMatrix(expenditure$X1, expenditure$Y, expenditure$Region, main = "Personal Income - Expenditure",
xlab = "Personal Income", ylab = "$Shelter Assistance", col="red",
points(expenditure$Region, expenditure$Y, col="blue", pch=17))
scatterplotMatrix(expenditure$X1, expenditure$Y, main = "Personal Income - Expenditure",
xlab = "Personal Income", ylab = "$Shelter Assistance", col="red",)
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Expenditure",
xlab = "Personal Income", ylab = "$Shelter Assistance", col="red",)
points(expenditure$Region, expenditure$Y, col="blue", pch=17)
# part 3
colors <- c('green', 'blue','red', 'black')
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Expenditure",
xlab = "Personal Income", ylab = "$Shelter Assistance",
pch = expenditure$Region, col = colors[expenditure$Region])
attach(expenditure)
par(mfrow = c(2,2))
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Shelter Assistance",
xlab = "Personal Income", ylab = "$Shelter Assistance",
)
plot(expenditure$X1, expenditure$Y, main = "Personal Income - Expenditure",
xlab = "Personal Income", ylab = "$Shelter Assistance",
pch = expenditure$Region, col = colors[expenditure$Region])
# We see that in the graph mapping personal income, there is somewhat of a positive
# correlation between state spending on shelter assistance and the per capita personal
# income in the state, with greater variation in the middle of the graph.
# In the graph mapping financial insecurity, there is a vague "U" shape of the
# relationship, suggesting a somewhat postive correlation with a slight bump with the
# states with the highest numbers of financially insecure residents spending more on
# shelter assistance than a strong positive correlation would suggest.
# In the graph considering urban area, there is a very weak positive correlation
# between the amount states spend on urban assistance and the number of residents
# living in urban areas.
pdf("PS01_Q2_pt1")
attach(expenditure)
plot(expenditure$X1, expenditure$X2, main = "Personal Income vs Financially Insecure",
xlab = "Personal Income", ylab = "Financially Insecure"
)
plot(expenditure$X1, expenditure$X3, main = "Personal Income vs Urban Residing",
xlab = "Personal Income", ylab = "Urban Residing"
)
plot(expenditure$X2, expenditure$X3, main = "Financially Insecure vs Urban Residing ",
xlab = "Financially Insecure", ylab = "Urban Residing"
)
t_obs = (mean - 50)/(sqrt(sd/n))
t_obs = (mean - 100)/(sqrt(sd/n))
pt(t_obs,df=n-1,lower.tail=FALSE)
pt(t_obs,df=n-1,upper.tail=FALSE)
pt(t_obs,df=n-1,lower.tail=TRUE)
#Problem 1 Part 2
a <- 0.05
pt(t_obs,df=n-1,lower.tail= FALSE)
pt(t_obs,df=n-1,lower.tail= TRUE)
t.test(y, greater, mu = 100, 0.05)
t.test(y,'greater', mu = 100, 0.05)
t.test(y, mu = 100)
p <- pt(t_obs,df=n-1,lower.tail= FALSE)
p <- pt(t_obs,df=n-1,lower.tail= TRUE)
#Problem 1 Part 2 (https://www.adamnsmith.com/MSIN0010/hypothesis-tests.html)
#(http://courses.washington.edu/psy315/tutorials/t_test_tutorial.pdf)
# Using one tailed t.test
#Standard Error
Sx <- (sd/sqr(25))
#Problem 1 Part 2 (https://www.adamnsmith.com/MSIN0010/hypothesis-tests.html)
#(http://courses.washington.edu/psy315/tutorials/t_test_tutorial.pdf)
# Using one tailed t.test
#Standard Error
Sx <- (sd/sqrt(25))
t_obs <- (mean - 100)/(Sx))
t_obs <- (mean - 100/(Sx))
t_obs <- ((mean - 100)/(Sx))
t_tab <- 1.711
pt(t_obs,df,lower.tail= TRUE)
pt(t_obs,df,lower.tail= FALSE)
pt(t_obs,df,lower.tail= TRUE)
p <- pt(t_obs,df,lower.tail= TRUE)
check <- t.test(y, mu = 100)
check <- t.test(y, mu = 100)
check <- t.test(y, mu = 100)
t.test(y, mu = 100)
View(check)
pt(t_obs,df,lower.tail= TRUE)
